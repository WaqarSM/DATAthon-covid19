"use strict";angular.module("onesite.contentType",["onesite.contentType.factories","onesite.contentType.directives","onesite.contentType.services"]);
"use strict";angular.module("onesite.contentType.directives",[]).directive("contentTypeSearchResults",["routeService","scrollService",function(t,n){var i=function(){n.scrollToElement(angular.element("#footer"),null,10)};return{scope:{mainController:"=",pageSize:"="},restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.scrollService=n,e.focusBackToTop=i,t.regulateRedirect(r.parent())}}}]).directive("contentTypeGeneric",["$timeout","redirectService","routeService","scrollService",function(t,n,i,o){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=n,e.scrollService=o,i.regulateRedirect(r.parent()),t(function(){angular.isFunction(e.mainController.update.header)&&e.mainController.update.header(e.mainController.node.content)},0)}}}]).directive("contentTypeOpenDataDetail",["redirectService","routeService","scrollService","urlConfig",function(t,n,i,o){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=t,e.scrollService=i,e.openDataAliasCollection=o.routes.openData,n.regulateRedirect(r.parent())}}}]).directive("contentTypeTradeCalendarDetail",["redirectService","routeService","scrollService","urlConfig",function(t,n,i,o){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=t,e.scrollService=i,e.tradeCalendarAliasCollection=o.routes.tradeCalendar,n.regulateRedirect(r.parent())}}}]).directive("contentTypeOrderInCouncilDetail",[function(){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="subClass.templateUrl"></div>',controller:["$scope","$element","redirectService","routeService","scrollService","urlConfig",function(e,r,t,n,i,o){n.regulateRedirect(r.parent()),e.redirectService=t,e.scrollService=i,e.subClass=e.mainController.node.content.subClass,e.orderInCouncilAliasCollection=o.routes.orderInCouncil}]}}]).directive("contentTypeFeatsDetail",["redirectService","routeService","scrollService","urlConfig","$location","$http","featsService",function(r,t,i,e,o,n,a){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(n,e){n.redirectService=r,n.scrollService=i,t.regulateRedirect(e.parent()),a.locationDetailsHandler.locationDetails().then(function(e){n.locationObject=e,n.lang="fr"===o.path().substring(1,3)?"fr":"en",n.currentYear=(new Date).getFullYear();var t={PR003_en:["Adult High School Credit Programs","/page/adult-learning"],PR003_fr:["Programmes à credits du secondaire pour adultes","/fr/page/formation-des-adultes"],PR013_en:["Literacy and Basic Skills","/page/adult-learning"],PR013_fr:["Alphabétisation et formation de base","/fr/page/formation-des-adultes"],PR015_en:["Ontario Employment Assistance Services",""],PR015_fr:["Services d'aide à l'emploi de l'Ontario",""],PR023_en:["Ontario Youth Apprenticeship Program","/page/prepare-apprenticeship#section-1"],PR023_fr:["Programmes d'apprentissage pour les jeunes","/fr/page/preparation-lapprentissage#section-1"],PR030_en:["Apprenticeship Office","/page/employment-ontario-apprenticeship-offices"],PR030_fr:["Apprentissage (bureau)","/fr/page/bureau-dapprentissage-demploi-ontario"],PR031_en:["Co-op Diploma Apprenticeship","/page/prepare-apprenticeship#section-3"],PR031_fr:["Apprentissage-diplôme","/fr/page/preparation-lapprentissage#section-3"],PR032_en:["Employment Service Sites (including Second Career)","/page/employment-ontario"],PR032_fr:["Services d'emploi de l'Ontario","/fr/page/emploi-ontario"],PR035_en:["Canada Ontario Job Grant",""],PR035_fr:["Subvention Canada-Ontario pour l'emploi\t",""],PR036_en:["Youth Job Connection","/page/get-help-finding-youth-or-student-job#section-1"],PR036_fr:["Programme d'accès à l'emploi pour les jeunes","/fr/page/jeunes-ou-etudiants-de-laide-pour-trouver-un-emploi#section-1"],PR040_en:["Youth Job Connection Summer","/page/get-help-finding-youth-or-student-job#section-2"],PR040_fr:["Programme d'accès aux emplois d'été pour les jeunes","/fr/page/jeunes-ou-etudiants-de-laide-pour-trouver-un-emploi#section-2"],PR041_en:["Youth Job Link","/page/get-help-finding-youth-or-student-job#section-0"],PR041_fr:["Programme d'orientation en matière d'emploi pour les jeunes","/fr/page/jeunes-ou-etudiants-de-laide-pour-trouver-un-emploi#section-0"]};e.data&&(n.service_category=e.data.field_category_id.map(function(e){var r=n.lang;return"<a href='"+t[e+"_"+r][1]+"' title='"+t[e+"_"+r][0]+"'>"+t[e+"_"+r][0]+"</a>"}))})}}}]).directive("contentTypeDocument",["$parse","scrollService","redirectService","routeService",function(n,i,o,a){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=o,e.scrollService=i,a.regulateRedirect(r.parent());var t=n("node.content.documentViewer.handler")(e.mainController);angular.isFunction(t)&&t()}}}]).directive("contentTypePage",["$timeout","scrollService","redirectService","routeService",function(t,n,i,o){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=i,e.scrollService=n,o.regulateRedirect(r.parent()),angular.isFunction(e.mainController.node.content.legacyGoogleMapLoader)&&t(function(){e.mainController.node.content.legacyGoogleMapLoader()},0)}}}]).directive("contentTypeDashboard",["$timeout","redirectService","routeService","externalLinks","scrollService",function(t,n,i,o,a){return{scope:!0,restrict:"A",replace:!0,template:'<div ng-include="mainController.node.content.subClass.templateUrl"></div>',link:function(e,r){e.redirectService=n,e.scrollService=a,e.homepage=o.welcome,i.regulateRedirect(r.parent()),t(function(){angular.isFunction(e.mainController.update.header)&&e.mainController.update.header(e.mainController.node.content)},0)}}}]);
"use strict";angular.module("onesite.contentType.factories",[]).factory("contentTypeFactory",["contentTypeService","componentFactory","enableRouting","urlConfig","$route",function(n,e,a,r,o){var i,l,c,s,d,p,u,m,g,h,f,y,b,_,v,U,k,C,T,P,R,D,F,t,G={},L=["coreComponent","taxonomy","language","metatags","analytics","ministerFooter","contact","footnote"],q={searchResults:(D=["header","intro","ministry","search"].concat(L),F=e.aggregateFields(D),function(e,t){return e.fields=F,e.disableRedirectToLegacy=!0,{template:['<div content-type-search-results main-controller="mainController"','page-size="',a||20,'">',"</div>"].join(""),promise:n.fetchSearchPage(e,t,D)};var a}),openTable:(R=["header"].concat(L),function(e,t){return{template:"<div content-type-generic></div>",promise:n.fetchGenericPage(e,t,R)}}),foodland:(P=["header"].concat(L),function(e,t){return{template:"<div content-type-generic></div>",promise:n.fetchGenericPage(e,t,P)}}),faq:(C=["header","body","toc","dateChanged","tags","ministry","breadcrumbs","banner"].concat(L),T=e.aggregateFields(C),function(e,t){return e.fields=T,e.disableRedirectToLegacy=!0,{template:"<div content-type-generic></div>",promise:n.fetchGenericPage(e,t,C)}}),landRegistrationDetail:(U=["header","body","dateChanged","tags","ministry","breadcrumbs","landRegistration"].concat(L),k=e.aggregateFields(U),function(e,t){return e.fields=k,e.disableRedirectToLegacy=!0,{template:"<div content-type-generic></div>",promise:n.fetchGenericPage(e,t,U)}}),openDataDetail:(_=["header","intro","body","dateChanged","tags","ministry","dataset"].concat(L),v=e.aggregateFields(_),function(e,t){return e.fields=v,e.disableRedirectToLegacy=!0,{template:"<div content-type-open-data-detail></div>",promise:n.fetchGenericPage(e,t,_)}}),tradeCalendarDetail:(y=["header","intro","body","dateChanged","tags","ministry","tradeCalendar"].concat(L),b=e.aggregateFields(y),function(e,t){return e.fields=b,e.disableRedirectToLegacy=!0,{template:"<div content-type-trade-calendar-detail></div>",promise:n.fetchGenericPage(e,t,y)}}),orderInCouncilDetail:(h=["header","body","dateChanged","ministry","orderInCouncil"].concat(L),f=e.aggregateFields(h),function(e,t){return e.fields=f,e.disableRedirectToLegacy=!0,{template:"<div content-type-order-in-council-detail></div>",promise:n.fetchGenericPage(e,t,h)}}),featsDetail:(m=["header","body","dateChanged","tags","ministry","orderInCouncil"].concat(L),g=e.aggregateFields(m),function(e,t){return e.fields=g,e.disableRedirectToLegacy=!0,{template:"<div content-type-feats-detail></div>",promise:n.fetchGenericPage(e,t,m)}}),document:(p=["header","intro","body","toc","dateChanged","right","tags","ministry","breadcrumbs","documentEmbedded","banner","customStyles","customScripts","book","archive"].concat(L),u=e.aggregateFields(p),function(e,t){return e.fields=u,e.disableRedirectToLegacy=!0,{template:"<div content-type-document></div>",promise:n.fetchGenericPage(e,t,p)}}),page:(s=["header","intro","archive","greyBox","body","toc","dateChanged","right","search","tags","ministry","breadcrumbs","banner","customStyles","customScripts"].concat(L),d=e.aggregateFields(s),function(e,t){return e.fields=d,e.disableRedirectToLegacy=!0,{template:"<div content-type-page></div>",promise:n.fetchGenericPage(e,t,s)}}),staticPage:(l=["header","ministerFooter","contactUs"].concat(L),c=e.aggregateFields(l),function(e,t){return e.fields=c,e.disableRedirectToLegacy=!0,{template:"<div content-type-generic></div>",promise:n.fetchStaticPage(e,t,l)}}),"#!":(i=[].concat(L),function(e,t){return e.alias="#!",{template:"<div content-type-dashboard></div>",promise:n.fetchDashboardPage(e,t,i)}})},x=(t={searchResults:!0,openTable:!1,foodland:!1,faq:!0,landRegistrationDetail:!0,openDataDetail:!0,tradeCalendarDetail:!0,orderInCouncilDetail:!0,featsDetail:!0,document:!0,article:!1,page:!0,staticPage:!0,"#!":!0},function(e){return t[e]});return G.isContentTypeEnabled=x,G.instantiate=function(e,t){return a?("article"===e.contentType&&(e.contentType="page"),q[e.contentType](e,t)):x(e.contentType)?q[e.contentType](e,t):n.redirectToLegacy(e,t)},G.determineContentType=function(e){e=e.replace(/(.*)\?(.*)/,"$1");var t="#!";for(var a in r.routes)if(r.routes.hasOwnProperty(a)){var n=r.routes[a];if(angular.isString(n.path)&&o.routes[n.path].regexp.test(e)){t=n.contentType;break}}return t},G}]).factory("staticPageFixFactory",["staticPageConfig","urlConfig","componentFactory","languageService","$route",function(s,d,p,u,m){var e={},g=function(e,t){for(var a in t)t.hasOwnProperty(a)&&e.hasOwnProperty(a)&&e[a].assign(this,t[a])};return e.fix=function(e,t){var a,n="/"+e;for(var r in s)if(s.hasOwnProperty(r)){for(var o in s[r])if(s[r].hasOwnProperty(o)&&angular.isString(e)){var i=d.routes[s[r][o].routeName].path,l=!!angular.isObject(m.routes[i])&&m.routes[i].regexp.test(n);if(l&&"en"!==o&&(l=n.replace(m.routes[i].regexp,"$1")===o),l){a=s[r][o];break}}if(angular.isObject(a))break}if(a){g.call(this,p.getGetter("coreComponent"),a.core);var c={};c[u.alternativeLanguage(t).lang]=a.translation,p.getGetter("language").translations.assign(this,c),p.getGetter("taxonomy").idTxt.assign(this,"3"),g.call(this,p.getGetter("ministerFooter"),a.ministerFooter),g.call(this,p.getGetter("contact"),a.contact)}return!!a},e}]).factory("subContentTypeFactory",["lazyloaderFactory","lazyloadFiles",function(t,a){var e={},i={searchResults:{"search-result":function(){return{templateUrl:"/core_modules/content-type/partials/searchResults/main-search.html",promise:null}},query_landing_page:function(){return{templateUrl:"/core_modules/content-type/partials/searchResults/query-landing-page.html",promise:null}},"ontario-gazette":function(){var e="onesite.moment";return{templateUrl:"/core_modules/content-type/partials/searchResults/ontario-gazette.html",promise:t.load(t.instantiate("module",e),{name:e,files:a[e]})}},land_registration_all:function(){return{templateUrl:"/core_modules/content-type/partials/searchResults/land-registration.html",promise:null}},query_page_oic:function(){var e="onesite.moment";return{templateUrl:"/core_modules/content-type/partials/searchResults/order-in-council.html",promise:t.load(t.instantiate("module",e),{name:e,files:a[e]})}},open_data_landing_page:function(){return{templateUrl:"/core_modules/content-type/partials/searchResults/open-data.html",promise:null}},tradecalendar_landing_page:function(){var e="onesite.moment";return{templateUrl:"/core_modules/content-type/partials/searchResults/trade-calendar.html",promise:t.load(t.instantiate("module",e),{name:e,files:a[e]})}}},openTable:{page:function(){return{templateUrl:"/core_modules/content-type/partials/openTable/template-page.html",promise:null}}},foodland:{page:function(){return{templateUrl:"/core_modules/content-type/partials/foodland/template-page.html",promise:null}}},faq:{faq:function(){return{templateUrl:"/core_modules/content-type/partials/faq/template-faq.html",promise:null}}},landRegistrationDetail:{land_registration_ontario:function(){return{templateUrl:"/core_modules/content-type/partials/landRegistrationDetail/template-land-registration.html",promise:null}}},openDataDetail:{dataset:function(){return{templateUrl:"/core_modules/content-type/partials/openDataDetail/template-open-data.html",promise:null}}},tradeCalendarDetail:{trade_calendar:function(){return{templateUrl:"/core_modules/content-type/partials/tradeCalendarDetail/template-trade-calendar.html",promise:null}}},orderInCouncilDetail:{order_in_council:function(){return{templateUrl:"/core_modules/content-type/partials/orderInCouncilDetail/template-order-in-council.html",promise:null}}},featsDetail:{feats_detail:function(){return{templateUrl:"/core_modules/content-type/partials/featsDetail/template-feats-detail.html",promise:null}}},document:{document_summary_page:function(){return{templateUrl:"/core_modules/content-type/partials/document/template-document-summary-page.html",promise:null}},book:function(){var e="onesite.book";return{templateUrl:"/core_modules/content-type/partials/document/template-book.html",promise:t.load(t.instantiate("module",e),{name:e,files:a[e]})}}},page:{page:function(){return{templateUrl:"/core_modules/content-type/partials/page/template-page.html",promise:null}},minister:function(){return{templateUrl:"/core_modules/content-type/partials/page/template-page.html",promise:null}},landing_page:function(){return{templateUrl:"/core_modules/content-type/partials/page/template-landing-page.html",promise:null}}},staticPage:{contact_us:function(){return{templateUrl:"/core_modules/content-type/partials/staticPage/contactUs/template-contact-us.html",promise:null}}},"#!":{kitchensink1:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/general.html",promise:null}},kitchensink2:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/deprecated-images.html",promise:null}},kitchensink3:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/deprecated-qa.html",promise:null}},kitchensink4:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/colours.html",promise:null}},kitchensink5:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/infographics.html",promise:null}},kitchensink6:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/deprecated-index.html",promise:null}},kitchensink7:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/datafile.html",promise:null}},kitchensink8:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/bargraph.html",promise:null}},kitchensink9:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/bargraph-internal-demos.html",promise:null}},splash:function(){return{templateUrl:"/core_modules/content-type/partials/dashboard/splash.html",promise:null}}}};i.document.book_page=i.document.book;var l={404:{templateUrl:"/core_modules/content-type/partials/staticPage/error/template-404.html",promise:null}};return e.instantiate=function(e,t){var a;if(i[e])a=i[e][t];else for(var n in i)if(i.hasOwnProperty(n))for(var r in i[n])if(r===t){a=i[n][r];break}var o=l[t]?l[t]:l[404];return angular.isFunction(a)?a():o},e}]);
"use strict";angular.module("onesite.contentType.services",["onesite.config"]).factory("contentTypeDaoService",["apiEndpointConfig","redirectService","env","componentDaoService","$cookies","$q","$http","$parse","$location","$window",function(e,n,u,s,t,f,r,o,c,i){var a,l,d,h,p,g={},v=!1,m=(a=function(){(function(){var e=this;e.withCredentials?(r.defaults.headers.common["X-Authorization"]=e.withCredentials,e.withCredentials=!0):(delete r.defaults.headers.common["X-Authorization"],delete e.withCredentials)}).call(this);var n=f.defer();return r(this).success(function(e){n.resolve(angular.isArray(e)?e[0]:e)}).error(function(e,t){n.reject({status:t})}),n.promise},l="/"+e["onesite.app"].apiService,d=e["onesite.app"].apiServiceCrossDomain,{getNode:function(e,t){return e.url=[t?l:n.respectProtocol(d+l),e.url].join("/"),a.call(e)},getAlias:function(e,t){return e.url=n.respectProtocol(t?l:d+l)+"/url/"+e.contentNodeId,delete e.contentNodeId,a.call(e)}}),y=function(e){var s,c,l;return s=e.errorCollection,c=e.makeRequest,l=e.fetchParams,function(a){var e={};e.fields=a.fields,a.share&&(e.share=a.share,v=!0);var t,n,r=(t=e,n=[],angular.forEach(t,function(e,t){n.push([t,e].join("="))}),n[0]?n.join("&"):null),o=encodeURIComponent(encodeURI(a.alias)),i=f.defer();return c(r?[o,r].join("?"):o).then(function(e){angular.isObject(e)?(e.fetchParams=l(),i.resolve(e)):i.reject({handler:void 0,errorStatus:500})},function(e){var t,n,r=(n=a,404===(t=e).status&&n.disableRedirectToLegacy||403===t.status&&"develop"===u?null:t.status);i.reject({handler:r?s[r]:null,errorStatus:e.status})}),i.promise}},C=new y({errorCollection:{403:new y({errorCollection:{},makeRequest:function(e){return m.getNode({url:e,method:"GET",withCredentials:["Bearer",t.get("bearer")].join(" ")},!0)},fetchParams:function(){return{withCredentials:["Bearer",t.get("bearer")].join(" "),useRelativeUrl:!0}}}),404:function(e){n.redirectToLegacy(e.absUrl)}},makeRequest:(p=function(){var n=f.defer(),e=function(){var e=s.coreComponent.getter.id(this),t=s.book.getter.bookId(this);return e===t?null:t}.call(this);/^[0-9]+$/.test(e+"")&&1*e!=0?m.getAlias({contentNodeId:e,method:"GET"},!1).then(function(e){var t=angular.isArray(e)?o("und[0].id")({und:e}):e.id;n.resolve(t)},function(e){n.reject(e)}):n.resolve();return n.promise},function(e){return function o(e){var i=this;return i.requestInit&&(h=f.defer()),m.getNode({url:e,method:"GET",withCredentials:!1},!1).then(function(a){s.coreComponent.getter.isPrivate(a)&&!v?h.reject({status:403}):p.call(a).then(function(e){if(angular.isString(e)&&""!==e.trim()){var t="share",n="?";c.search().share?(n+="share="+c.search().share+"&",sessionStorage.setItem(t,c.search().share)):sessionStorage.getItem(t)&&(n="share="+sessionStorage.getItem(t)+"&");var r=encodeURIComponent(e)+n+"fields="+s.coreComponent.fieldList.concat(s.customStyles.fieldList).concat(s.customScripts.fieldList).join(",");o.call(a,r)}else i.field_custom_styles=a.field_custom_styles,i.field_custom_scripts=a.field_custom_scripts,i.field_custom_scripts_header=a.field_custom_scripts_header,h.resolve(i.requestInit?a:i)},function(){h.resolve(i)})},function(e){h.reject(e)}),h.promise}.call({requestInit:!0},e)}),fetchParams:function(){return{withCredentials:!1,useRelativeUrl:!1}}});return g.FetchHandler=function(e){var n,r,t,a=o("nid");return n=e,t=function t(e){return e.errorStatus||(r=f.defer()),e.handler(n).then(function(e){(function(){var e=a(this);return angular.isString(e)?""!==e.trim():!!angular.isNumber(e)&&!isNaN(e)}).call(e)?r.resolve(e):e.redirect&&e.redirect.isExternal?i.location.href=e.redirect.to:r.reject({handler:void 0,errorStatus:500})},function(e){angular.isFunction(e.handler)?t(e):r.reject(e.errorStatus)}),r.promise},function(){return t({handler:C,errorStatus:null})}},g}]).factory("featsDaoService",["$location","$http","$q","apiEndpointConfig","getterFactory","dataBindingService",function(e,n,r,a,t,o){var i,s={},c=parseInt(e.search().fid),l=e.search().lang,u={data:t.instantiate("data.data[0].attributes")};return s.api=function(){i="fr"===l?[a["onesite.feats"].apiServiceCrossDomainFr,"?filter[field_fid][value]=",c,"&filter[langcode][value]=fr"].join(""):[a["onesite.feats"].apiServiceCrossDomain,"?filter[field_fid][value]=",c].join("");var t=r.defer();return n({url:i,method:"GET"}).then(function(e){t.resolve(o.bindData(e,u))},function(){t.reject()}),t.promise},s}]).factory("featsService",["featsDaoService",function(e){var t={};return t.locationDetailsHandler=new function(){return{locationDetails:function(){return e.api()}}},t}]).factory("contentTypeService",["dataBindingService","contentTypeDaoService","urlConfig","subContentTypeFactory","componentFactory","staticPageFixFactory","showKitchenSink","lazyloaderFactory","lazyloadFiles","scopeService","redirectService","languageService","analyticsErrorService","$q","$templateCache","$parse","$window","$location",function(p,e,u,n,g,l,v,t,r,m,f,y,d,C,a,o,h,S){var i={},w=function(e,t,n){return{content:e||{},contact:t||{},ministerFooter:n||{}}},b=o("node.content.params"),j=function(e,t){return this.content.subClass=n.instantiate(e,t),this.content.subClass.templateUrl&&a.remove(this.content.subClass.templateUrl),this.content.subClass.promise},T=function(e,t,n){var r=C.defer(),a=g.getGetter("coreComponent"),o=[],i={};(function(e,t){e.lang.assign(this,y.currentLanguage.get()),e.type.assign(this,t)}).call(i,a,t.errorStatus),function(e){e.idTxt.assign(this,"3")}.call(i,g.getGetter("taxonomy"));var s=this;s.content=p.bindData(i,a),s.content.headerType="default";var c=j.call(s,e,t.errorStatus);c&&o.push(c);var l=g.instantiate.call(s,"taxonomy",i);return l&&o.push(l),o.push(y.lazyloadTranslations(s.content.lang)),d(t,n,f.referrer),C.all(o).then(function(){r.resolve(s)},function(){r.resolve(s)}),r.promise},_=function(n,t){var r=C.defer();return new e.FetchHandler(n)().then(function(e){if(e){y.lazyloadTranslations(t(e)).then(function(){r.resolve(e)},function(){T.call(new w,n.contentType,{errorStatus:null,errorReason:"translation is not loaded successfully"},n).then(function(e){r.reject(e)})})}else{T.call(new w,n.contentType,{errorStatus:null,errorReason:"the fetched content is invalid"},n).then(function(e){r.reject(e)})}},function(e){var t={errorStatus:e,errorReason:"the fetch for the content is unsuccessful"};T.call(new w,n.contentType,t,n).then(function(e){n.lang&&(e.content.lang=n.lang),r.reject(e)})}),r.promise},I=function(e,t){var n=!1;for(var r in e)if(e.hasOwnProperty(r)&&e[r].default===t){n=!0;break}return n};return i.fetchSearchPage=function(o,i,s){var c=C.defer(),l=g.getGetter("coreComponent"),e=b(m.getMainController());if(o.alias&&e&&o.alias===e.alias){if(I(u.routes.gazette,e.alias)||I(u.routes.landRegistration,e.alias)||I(u.routes.openData,e.alias)||I(u.routes.tradeCalendar,e.alias)||I(u.routes.featsDetail,e.alias)||I(u.routes.orderInCouncil,e.alias))return c.reject(),c.promise;b.assign(m.getMainController(),o)}return _(o,l.lang).then(function(e){if(e.redirect)h.location.href=e.redirect.to;else{var t=y.normalizeLanguage(l.lang(e));u.routes.searchResults[t].default===o.alias?l.type.assign(e,"search-result"):u.routes.gazette[t].default===o.alias&&l.type.assign(e,"ontario-gazette");var n=new w(p.bindData(e,l));n.content.params=o,n.content.queryParams=i||{};var r=[],a=j.call(n,o.contentType,n.content.type);a&&r.push(a),r=r.concat(g.batchInstantiate.call(n,s,e,o,i)),C.all(r).then(function(){n.contact.contactUsAllowed={"ontario-gazette":!0,query_page_oic:!0,open_data_landing_page:!0},n.contact.contactUsAllowed[n.content.type]||(n.contact.contactUs=null),c.resolve(n)},function(){c.resolve(n)})}},function(e){c.resolve(e)}),c.promise},i.fetchGenericPage=function(o,i,s){var c=C.defer(),l=g.getGetter("coreComponent"),e=b(m.getMainController());return o.alias&&e&&o.alias===e.alias?(b.assign(m.getMainController(),o),c.reject()):_(o,l.lang).then(function(e){var t=new w(p.bindData(e,l));t.content.params=o;var n=[],r=e.redirect?e.redirect.to.split("/")[0]:o.contentType,a=j.call(t,r,t.content.type);a&&n.push(a),n=n.concat(g.batchInstantiate.call(t,s,e,o,i)),e.redirect&&(S.path(e.redirect.to,!1),t.content.redirect=e.redirect),C.all(n).then(function(){c.resolve(t)},function(){c.resolve(t)})},function(e){c.resolve(e)}),c.promise},i.fetchStaticPage=function(r,a,o){var i=C.defer(),s=g.getGetter("coreComponent"),e=b(m.getMainController());if(r.alias&&e&&r.alias===e.alias)return b.assign(m.getMainController(),r),i.reject(),i.promise;var c={},t=y.normalizeLanguage(r.aliasLang)||"en";return l.fix.call(c,r.alias,t)?y.lazyloadTranslations(t).then(function(){var e=new w(p.bindData(c,s));e.content.params=r;var t=[],n=j.call(e,r.contentType,e.content.type);n&&t.push(n),t=t.concat(g.batchInstantiate.call(e,o,c,r,a)),e.content.titleMetatag=e.content.title,C.all(t).then(function(){i.resolve(e)},function(){i.resolve(e)})},function(e){i.resolve(e)}):T.call(new w,r.contentType,null,r).then(function(e){i.resolve(e)}),i.promise},i.fetchDashboardPage=function(e,t,n){var r=C.defer(),a=g.getGetter("coreComponent"),o=b(m.getMainController()),i=v&&"kitchensink"===t.type;if(e.alias&&o&&e.alias===o.alias&&!i)return b.assign(m.getMainController(),e),r.reject(),r.promise;var s={};if(a.lang.assign(s,y.currentLanguage.get()),a.type.assign(s,"splash"),i){var c,l=6;angular.isString(t.page)&&""!==t.page.trim()&&6!==(c=parseInt(t.page))&&(l=c);var u=!1;if(c?o&&o.page&&c.toString()===o.page.toString()&&(u=!0):o&&!o.page&&(u=!0),u)return r.reject(),r.promise;a.type.assign(s,"kitchensink"+l)}var f=new w(p.bindData(s,a));f.content.params=e;var d=[],h=j.call(f,e.contentType,f.content.type);return h&&d.push(h),d=d.concat(g.batchInstantiate.call(f,n,s,e,t)),C.all(d).then(function(){r.resolve(f)},function(){r.resolve(f)}),r.promise},i.redirectToLegacy=function(e){var t=C.defer();return t.promise.then(function(){window.location.href=e.absUrl}),t.resolve(),{template:"",promise:t.promise}},i}]);
/*
     FILE ARCHIVED ON 19:20:22 Mar 14, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:31:44 Mar 20, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 1220.556
  exclusion.robots: 0.137
  exclusion.robots.policy: 0.128
  CDXLines.iter: 80.62 (4)
  PetaboxLoader3.datanode: 770.977 (5)
  LoadShardBlock: 336.692 (4)
  esindex: 0.039
  load_resource: 1174.266
  PetaboxLoader3.resolve: 674.861
  RedisCDXSource: 8.359
*/