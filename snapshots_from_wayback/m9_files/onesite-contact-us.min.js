"use strict";angular.module("onesite.contact.us",["onesite.contact.us.services","onesite.contact.us.directives"]);
"use strict";angular.module("onesite.contact.us.services",[]).factory("contactUsService",["remoteStorageService","sessionService","dataBindingService","apiEndpointConfig","componentApiService","redirectService","$q","$parse",function(a,e,t,c,s,d,u,l){var r={};return r.getContactNode=function(r,n,e){var i="/"+c["onesite.app"].apiService,o=c["onesite.app"].apiServiceCrossDomain,a=u.defer();return function(e,t){var r="/"+c["onesite.app"].apiService,n=c["onesite.app"].apiServiceCrossDomain,i=u.defer();return s.getEntity({url:d.respectProtocol(t.useRelativeUrl?r:n+r)+"/url/"+e,method:"GET",withCredentials:t.withCredentials}).then(function(e){var t=angular.isArray(e)?l("und[0].id")({und:e}):e.id;t?i.resolve(t):i.reject()},function(){i.reject()}),i.promise}(e,n).then(function(t){if(angular.isString(t)&&""!==t.trim()){var e=encodeURIComponent(t);s.getEntity({url:d.respectProtocol(n.useRelativeUrl?i:o+i)+"/"+e+"?fields="+r,method:"GET",withCredentials:n.withCredentials}).then(function(e){a.resolve({alias:t,content:angular.isArray(e)?e[0]:e})},function(){a.reject()})}else a.reject()},function(){a.reject()}),a.promise},r.Handler=function(e){return t=e.alias,r=e.ministryId,n=e.contactId,i={isLocked:!1,remote:{handler:new a.Handler({endPoint:"contact"})}},o=!!n,{set:function(e){return function(e,t,r,n,i){var o=this,a=u.defer();return!e||o.isLocked?a.reject():(o.isLocked=!0,t.referrer=r,t.contactId=parseInt(i),t.userAgent=navigator.userAgent,t.grecaptchaResponse=grecaptcha.getResponse(),o.remote.handler({alias:r,contactId:parseInt(i),ministryId:parseInt(n),contactUs:t}).then(function(){a.resolve(),o.isLocked=!1},function(){a.reject(),o.isLocked=!1})),a.promise}.call(i,o,e,t,r,n)}};var t,r,n,i,o},r}]);
"use strict";angular.module("onesite.contact.us.directives",[]).directive("onesiteContactUs",["$timeout","scrollService","analyticsTypeaheadService","redirectService","apiKeys",function(u,d,f,e,r){return{restrict:"E",replace:!0,scope:{contactUs:"="},templateUrl:"/onesite_modules/onesite-contact-us/partials/onesiteContactUs.html",link:function(t,a){t.aliasToPath=e.aliasToPath,angular.element(document).foundation("alert","reflow"),t.form={reply:!1,lang:t.contactUs.lang},t.submitted=!1,t.submitState=null,t.submit=function(e){13!==e.keyCode&&"click"!==e.type||function(t){var a=this;function e(){a.submitState="error",r.removeAttr("disabled"),u(function(){var e=document.getElementById("error_general");e.setAttribute("tabindex",-1),e.focus(),e.removeAttribute("tabindex")})}var r=t.find('button[type="submit"]');r.attr("disabled","disabled");var n=a.contactForm["verify-email"].$dirty||a.contactForm["verify-email"].$touched||document.getElementById("verify-email").value,i=a.contactForm.message.$dirty&&grecaptcha&&0<grecaptcha.getResponse().length;if(n)e();else if(a.contactForm.$valid)if(i){if(angular.isFunction(a.contactUs.handler.set)){a.submitState="submitting";var o=a.contactUs.handler.set(a.form);a.submitState=null,o.then(function(){a.submitted=!0,u(function(){var e=t.find("[thank-you-message]");e[0]&&angular.isFunction(e[0].focus)&&(d.scrollToElement(e),e.attr("tabindex",0),e[0].focus(),e.attr("tabindex",-1),r.removeAttr("disabled"),a.submitState="")},500,!1)},e);var s=Array();s.push(a.form.reply?"reply-yes":"reply-no"),s.push(a.form.name?"name-yes":"name-no"),s.push(a.form.tel?"phone-yes":"phone-no"),s.push(a.form.address?"address-yes":"address-no"),f("feature","contact-us",s,a.form.message.length)}}else{a.submitState="captcha",r.removeAttr("disabled");var c=document.getElementById("g-recaptcha-container");c.setAttribute("tabindex",-1),c.focus(),c.removeAttribute("tabindex")}else if(a.submitState="",r.removeAttr("disabled"),a.contactForm.message.$valid){if(!a.contactForm.email.$valid){a.contactForm.email.$error.minlength=!0;var l=t.find("#email");d.scrollToElement(l),l.attr("tabindex",0),l[0].focus(),l.attr("tabindex",-1)}}else{a.contactForm.message.$error.minlength=!0;var m=t.find("#message");d.scrollToElement(m),m.attr("tabindex",0),m[0].focus(),m.attr("tabindex",-1)}}.call(t,a)},grecaptcha.render("g-recaptcha",{sitekey:r.reCAPTCHAv2})}}}]);
/*
     FILE ARCHIVED ON 15:16:25 Mar 09, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:25:54 Mar 20, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  esindex: 0.012
  exclusion.robots.policy: 0.174
  LoadShardBlock: 185.34 (4)
  captures_list: 1076.852
  exclusion.robots: 0.187
  CDXLines.iter: 87.34 (4)
  PetaboxLoader3.datanode: 80.001 (6)
  RedisCDXSource: 1.635
  PetaboxLoader3.resolve: 95.026 (2)
  load_resource: 129.542
*/